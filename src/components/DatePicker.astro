---
const { id, nameStart, nameEnd, required } = Astro.props;
---

<div class="relative">
  <input type="text"
    id={id}
    placeholder="Select date range"
    class="form-input cursor-pointer"
    readonly
    {required}
  />
  <input type="hidden" name={nameStart} id={`${id}-start`} />
  <input type="hidden" name={nameEnd} id={`${id}-end`} />
</div>

<script type="module">
import flatpickr from "flatpickr";
import "flatpickr/dist/flatpickr.min.css";

const input = document.getElementById("{id}");
const startInput = document.getElementById("{id}-start");
const endInput = document.getElementById("{id}-end");

flatpickr(input, {
  mode: "range",
  dateFormat: "Y-m-d",
  onClose: function(selectedDates) {
    if (selectedDates.length === 2) {
      startInput.value = selectedDates[0].toISOString().split("T")[0];
      endInput.value = selectedDates[1].toISOString().split("T")[0];
    }
  }
});
</script>
