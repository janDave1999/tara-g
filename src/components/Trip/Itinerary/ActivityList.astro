---
// File: src/components/itinerary/ActivityList.astro
// Activities list within a stop

import type { StopActivity } from '@/types/itinerary';

interface Props {
  activities: StopActivity[];
  stopId: string;
  isOwner: boolean;
}

const { activities, stopId, isOwner } = Astro.props;
---

{activities && activities.length > 0 && (
  <div class="activities-section space-y-2 mt-3">
    <div class="flex items-center justify-between">
      <p class="text-xs font-bold text-gray-500 uppercase tracking-wide">Activities:</p>
      {isOwner && (
        <button class="add-activity-btn text-xs font-semibold text-blue-600 hover:text-blue-700 items-center gap-1 hidden">
          <svg class="w-3 h-3 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          Add Activity
        </button>
      )}
    </div>
    <div class="activities-list space-y-2">
      {activities.map((activity) => (
        <div class="activity-item flex items-center gap-3 bg-white/70 p-2 rounded-lg group/activity" data-activity-id={activity.id}>
          <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
          <div class="flex-1">
            <span class="text-sm font-semibold text-gray-800">{activity.description}</span>
          </div>
          <span class="text-xs font-bold text-gray-600 bg-gray-100 px-2 py-1 rounded">
            {activity.planned_duration_minutes} mins
          </span>
          {isOwner && (
            <div class="activity-controls opacity-0 group-hover/activity:opacity-100 transition-opacity gap-1 hidden">
              <button class="edit-activity-btn p-1 hover:bg-white rounded" title="Edit activity">
                <svg class="w-3 h-3 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </button>
              <button class="delete-activity-btn p-1 hover:bg-white rounded" title="Delete activity">
                <svg class="w-3 h-3 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
              </button>
            </div>
          )}
        </div>
      ))}
    </div>
  </div>
)}

{isOwner && (!activities || activities.length === 0) && (
  <button class="add-activity-btn mt-3 text-sm font-semibold text-blue-600 hover:text-blue-700 items-center gap-1 hidden" data-stop-id={stopId}>
    <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
    </svg>
    Add Activity
  </button>
)}